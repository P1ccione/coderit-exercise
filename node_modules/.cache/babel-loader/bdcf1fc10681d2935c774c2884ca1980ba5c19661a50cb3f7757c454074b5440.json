{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, vShow as _vShow, withDirectives as _withDirectives, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"content-container\"\n};\nconst _hoisted_3 = {\n  class: \"form-container\"\n};\nconst _hoisted_4 = {\n  class: \"form-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Header = _resolveComponent(\"Header\");\n  const _component_TeachersContainer = _resolveComponent(\"TeachersContainer\");\n  const _component_AddTeacherForm = _resolveComponent(\"AddTeacherForm\");\n  const _component_EditTeacherForm = _resolveComponent(\"EditTeacherForm\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_Header, {\n    onToggleTeachersContainer: $options.toggleTeachersContainer\n  }, null, 8 /* PROPS */, [\"onToggleTeachersContainer\"]), _createElementVNode(\"div\", _hoisted_2, [_withDirectives(_createVNode(_component_TeachersContainer, {\n    onToggleCreateTeacher: $options.toggleCreateTeacher,\n    onEditTeacher: $options.EditTeacherForm,\n    onDeleteTeacher: $options.deleteTeacher,\n    teachers: $data.teachers,\n    onToggleEditTeacher: $options.toggleEditTeacherForm\n  }, null, 8 /* PROPS */, [\"onToggleCreateTeacher\", \"onEditTeacher\", \"onDeleteTeacher\", \"teachers\", \"onToggleEditTeacher\"]), [[_vShow, $data.showTeachersContainer]]), _withDirectives(_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_AddTeacherForm, {\n    onCreateTeacher: $options.createTeacher,\n    onToggleCreateTeacher: $options.toggleCreateTeacher\n  }, null, 8 /* PROPS */, [\"onCreateTeacher\", \"onToggleCreateTeacher\"])], 512 /* NEED_PATCH */), [[_vShow, $data.showCreateTeacher]]), _withDirectives(_createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_EditTeacherForm, {\n    onEditTeacher: $options.EditTeacherForm,\n    onToggleEditTeacher: $options.toggleEditTeacherForm,\n    teacher: $data.editingTeacher\n  }, null, 8 /* PROPS */, [\"onEditTeacher\", \"onToggleEditTeacher\", \"teacher\"])], 512 /* NEED_PATCH */), [[_vShow, $data.showEditTeacherForm]])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_Header","onToggleTeachersContainer","$options","toggleTeachersContainer","_createElementVNode","_hoisted_2","_component_TeachersContainer","onToggleCreateTeacher","toggleCreateTeacher","onEditTeacher","EditTeacherForm","onDeleteTeacher","deleteTeacher","teachers","$data","onToggleEditTeacher","toggleEditTeacherForm","showTeachersContainer","_hoisted_3","_component_AddTeacherForm","onCreateTeacher","createTeacher","showCreateTeacher","_hoisted_4","_component_EditTeacherForm","teacher","editingTeacher","showEditTeacherForm"],"sources":["C:\\Users\\SimonePiscozzo\\vue-exercise\\src\\App.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <Header @toggle-teachers-container=\"toggleTeachersContainer\" />\n    <div class=\"content-container\">\n      <TeachersContainer v-show=\"showTeachersContainer\" @toggle-create-teacher=\"toggleCreateTeacher\" @edit-teacher=\"EditTeacherForm\" @delete-teacher=\"deleteTeacher\" :teachers=\"teachers\" @toggle-edit-teacher=\"toggleEditTeacherForm\" />\n      <div class=\"form-container\" v-show=\"showCreateTeacher\">\n        <AddTeacherForm @create-teacher=\"createTeacher\" @toggle-create-teacher=\"toggleCreateTeacher\"/>\n      </div>\n      <div class=\"form-container\" v-show=\"showEditTeacherForm\">\n        <EditTeacherForm @edit-teacher=\"EditTeacherForm\" @toggle-edit-teacher=\"toggleEditTeacherForm\" :teacher=\"editingTeacher\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import Header from \"./components/Header\"\n  import AddTeacherForm from \"./components/AddTeacherForm\"\n  import TeachersContainer from \"./components/TeachersContainer\"\n  import EditTeacherForm from \"./components/EditTeacherForm\"\n\n  export default {\n    name: 'App',\n    components: {\n      Header,\n      AddTeacherForm,\n      TeachersContainer,\n      EditTeacherForm,\n    },\n    data() {\n      return {\n        teachers: [],\n        showCreateTeacher: false,\n        showEditTeacherForm: false,\n        showTeachersContainer: true,\n        editingTeacher: null\n      }\n    },\n    async created() {\n      this.teachers = await this.fetchTeachers();\n    },\n    methods: {\n      // fetch dei dati nel file db.json dell'array teachers\n      async fetchTeachers() {\n        const res = await fetch(\"http://localhost:5000/teachers\")\n\n        const data = await res.json()\n\n        return data;\n      },\n      async fetchTeacher(id) {\n        const res = await fetch(`http://localhost:5000/teachers/${id}`)\n\n        const data = await res.json()\n\n        return data\n      },\n      async deleteTeacher(id) {\n        // console.log('task', id);\n        if(confirm('Are you sure?')) {\n                \n          const res = await fetch(`http://localhost:5000/teachers/${id}`, {\n            method: \"DELETE\",\n          })\n\n          res.status === 200 ? (this.teachers = this.teachers.filter((teacher) => teacher.id !== id)) : alert(\"Error deleting teacher\")\n        }\n      },\n\n      async isEmailExists(email) {\n        // Effettua una chiamata API per verificare se esiste già un insegnante con la stessa email\n        const res = await fetch(`http://localhost:5000/teachers?email=${email}`);\n        const data = await res.json();\n\n        return data.length > 0; // Restituisce true se esiste già un insegnante con la stessa email, altrimenti false\n      },\n\n      async isPhoneExists(phonenumber) {\n        // Effettua una chiamata API per verificare se esiste già un insegnante con lo stesso numero di telefono\n        const res = await fetch(`http://localhost:5000/teachers?phonenumber=${phonenumber}`);\n        const data = await res.json();\n\n        return data.length > 0; // Restituisce true se esiste già un insegnante con lo stesso numero di telefono, altrimenti false\n      },\n\n      async EditTeacherForm(id, newTeacher) {\n        const teacherToEdit = await this.fetchTeacher(id);\n\n        // Verifica se esiste già un insegnante con la stessa email\n        const isEmailExisting = await this.isEmailExists(newTeacher.email);\n        if (isEmailExisting) {\n          alert('Esiste già un insegnante con la stessa email.');\n          return;\n        }\n\n        // Verifica se esiste già un insegnante con lo stesso numero di telefono\n        const isPhoneExisting = await this.isPhoneExists(newTeacher.phonenumber);\n        if (isPhoneExisting) {\n          alert('Esiste già un insegnante con lo stesso numero di telefono.');\n          return;\n        }\n\n        const upTeacher = {\n          id: teacherToEdit.id,\n          ...newTeacher,\n        };\n\n        const res = await fetch(`http://localhost:5000/teachers/${id}`, {\n          method: \"PUT\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify(upTeacher),\n        });\n\n        const data = await res.json();\n\n        // Aggiorna la lista degli insegnanti con il nuovo dato ricevuto dal server\n        this.teachers = this.teachers.map((teacher) =>\n          teacher.id === id ? { ...teacher, ...data } : teacher\n        );\n\n        this.showEditTeacherForm = !this.showEditTeacherForm;\n      },\n\n      async createTeacher(teacher) {\n        // Verifica se esiste già un insegnante con la stessa email\n        const isEmailExisting = await this.isEmailExists(teacher.email);\n        if (isEmailExisting) {\n          alert('Esiste già un insegnante con la stessa email.');\n          return;\n        }\n\n        // Verifica se esiste già un insegnante con lo stesso numero di telefono\n        const isPhoneExisting = await this.isPhoneExists(teacher.phonenumber);\n        if (isPhoneExisting) {\n          alert('Esiste già un insegnante con lo stesso numero di telefono.');\n          return;\n        }\n\n        const res = await fetch(\"http://localhost:5000/teachers\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(teacher),\n        });\n\n        const data = await res.json();\n\n        this.teachers = [...this.teachers, data];\n        this.showForm = !this.showForm;\n        this.showCreateTeacher = !this.showCreateTeacher;\n      },\n      \n      // toggle del form create teacher\n      toggleCreateTeacher() {\n        this.showCreateTeacher = !this.showCreateTeacher\n      },\n\n      toggleEditTeacherForm(teacher) {\n        this.editingTeacher = teacher;\n        this.showEditTeacherForm = !this.showEditTeacherForm\n      },\n\n      toggleTeachersContainer() {\n        console.log(this.showTeachersContainer);\n        if(!this.showTeachersContainer){\n          this.showTeachersContainer = !this.showTeachersContainer\n        }\n      },\n\n    }\n  }\n</script>\n<style>\n  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400&display=swap');\n    \n  * {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n    /* outline: 1px orange solid */\n  }\n\n  body {\n    font-family: 'Poppins', sans-serif;\n  }\n\n  .container {\n    width: 100%;\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .content-container {\n    width: 100%;\n    height: auto;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .form-container {\n    position: absolute;\n    width: 100%;\n    height: 100vh;\n    top:0;\n    display: flex;\n    flex-direction: column;\n    row-gap: 50px;\n    justify-content: center;\n    align-items: center;\n    background-color: rgba(0,0,0,0.3);\n    backdrop-filter: blur(2px);\n  }\n\n</style>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAW;;EAEfA,KAAK,EAAC;AAAmB;;EAEvBA,KAAK,EAAC;AAAgB;;EAGtBA,KAAK,EAAC;AAAgB;;;;;;uBAP/BC,mBAAA,CAWM,OAXNC,UAWM,GAVJC,YAAA,CAA+DC,iBAAA;IAAtDC,yBAAyB,EAAEC,QAAA,CAAAC;EAAuB,wDAC3DC,mBAAA,CAQM,OARNC,UAQM,G,gBAPJN,YAAA,CAAmOO,4BAAA;IAAhLC,qBAAqB,EAAEL,QAAA,CAAAM,mBAAmB;IAAGC,aAAY,EAAEP,QAAA,CAAAQ,eAAe;IAAGC,eAAc,EAAET,QAAA,CAAAU,aAAa;IAAGC,QAAQ,EAAEC,KAAA,CAAAD,QAAQ;IAAGE,mBAAmB,EAAEb,QAAA,CAAAc;uIAA/KF,KAAA,CAAAG,qBAAqB,E,mBAChDb,mBAAA,CAEM,OAFNc,UAEM,GADJnB,YAAA,CAA8FoB,yBAAA;IAA7EC,eAAc,EAAElB,QAAA,CAAAmB,aAAa;IAAGd,qBAAqB,EAAEL,QAAA,CAAAM;2GADtCM,KAAA,CAAAQ,iBAAiB,E,mBAGrDlB,mBAAA,CAEM,OAFNmB,UAEM,GADJxB,YAAA,CAA0HyB,0BAAA;IAAxGf,aAAY,EAAEP,QAAA,CAAAQ,eAAe;IAAGK,mBAAmB,EAAEb,QAAA,CAAAc,qBAAqB;IAAGS,OAAO,EAAEX,KAAA,CAAAY;kHADtEZ,KAAA,CAAAa,mBAAmB,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}