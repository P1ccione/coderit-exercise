{"ast":null,"code":"import { resolveComponent as _resolveComponent, vShow as _vShow, createVNode as _createVNode, withDirectives as _withDirectives, createElementVNode as _createElementVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"form-container\"\n};\nconst _hoisted_2 = {\n  class: \"form-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_TeachersContainer = _resolveComponent(\"TeachersContainer\");\n  const _component_AddTeacherForm = _resolveComponent(\"AddTeacherForm\");\n  const _component_EditTeacherForm = _resolveComponent(\"EditTeacherForm\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_withDirectives(_createVNode(_component_TeachersContainer, {\n    onToggleCreateTeacher: _ctx.toggleCreateTeacher,\n    onEditTeacher: $options.EditTeacherForm,\n    onDeleteTeacher: $options.deleteTeacher,\n    teachers: _ctx.teachers,\n    onToggleEditTeacher: _ctx.toggleEditTeacherForm\n  }, null, 8 /* PROPS */, [\"onToggleCreateTeacher\", \"onEditTeacher\", \"onDeleteTeacher\", \"teachers\", \"onToggleEditTeacher\"]), [[_vShow, _ctx.showTeachersContainer]]), _withDirectives(_createElementVNode(\"div\", _hoisted_1, [_createVNode(_component_AddTeacherForm, {\n    onCreateTeacher: $options.createTeacher,\n    onToggleCreateTeacher: _ctx.toggleCreateTeacher\n  }, null, 8 /* PROPS */, [\"onCreateTeacher\", \"onToggleCreateTeacher\"])], 512 /* NEED_PATCH */), [[_vShow, _ctx.showCreateTeacher]]), _withDirectives(_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_EditTeacherForm, {\n    onEditTeacher: $options.EditTeacherForm,\n    onToggleEditTeacher: _ctx.toggleEditTeacherForm,\n    teacher: _ctx.editingTeacher\n  }, null, 8 /* PROPS */, [\"onEditTeacher\", \"onToggleEditTeacher\", \"teacher\"])], 512 /* NEED_PATCH */), [[_vShow, _ctx.showEditTeacherForm]])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createVNode","_component_TeachersContainer","onToggleCreateTeacher","_ctx","toggleCreateTeacher","onEditTeacher","$options","EditTeacherForm","onDeleteTeacher","deleteTeacher","teachers","onToggleEditTeacher","toggleEditTeacherForm","showTeachersContainer","_createElementVNode","_hoisted_1","_component_AddTeacherForm","onCreateTeacher","createTeacher","showCreateTeacher","_hoisted_2","_component_EditTeacherForm","teacher","editingTeacher","showEditTeacherForm"],"sources":["C:\\Users\\SimonePiscozzo\\vue-exercise\\src\\views\\TeachersView.vue"],"sourcesContent":["<template>\r\n    <TeachersContainer v-show=\"showTeachersContainer\" @toggle-create-teacher=\"toggleCreateTeacher\" @edit-teacher=\"EditTeacherForm\" @delete-teacher=\"deleteTeacher\" :teachers=\"teachers\" @toggle-edit-teacher=\"toggleEditTeacherForm\" />\r\n      <div class=\"form-container\" v-show=\"showCreateTeacher\">\r\n        <AddTeacherForm @create-teacher=\"createTeacher\" @toggle-create-teacher=\"toggleCreateTeacher\"/>\r\n      </div>\r\n      <div class=\"form-container\" v-show=\"showEditTeacherForm\">\r\n        <EditTeacherForm @edit-teacher=\"EditTeacherForm\" @toggle-edit-teacher=\"toggleEditTeacherForm\" :teacher=\"editingTeacher\" />\r\n      </div>\r\n</template>\r\n\r\n<script>\r\n    import AddTeacherForm from \"./components/AddTeacherForm\"\r\n    import TeachersContainer from \"./components/TeachersContainer\"\r\n    import EditTeacherForm from \"./components/EditTeacherForm\"\r\n\r\n    export default {\r\n        name: \"TeachersView\",\r\n        components: {\r\n            AddTeacherForm,\r\n            TeachersContainer,\r\n            EditTeacherForm,\r\n        },\r\n        async created() {\r\n            this.teachers = await this.fetchTeachers();\r\n        },\r\n        methods: {\r\n            async fetchTeachers() {\r\n                const res = await fetch(\"http://localhost:5000/teachers\")\r\n\r\n                const data = await res.json()\r\n\r\n                return data;\r\n            },\r\n            async fetchTeacher(id) {\r\n                const res = await fetch(`http://localhost:5000/teachers/${id}`)\r\n\r\n                const data = await res.json()\r\n\r\n                return data\r\n            },\r\n            async deleteTeacher(id) {\r\n                // console.log('task', id);\r\n                if(confirm('Are you sure?')) {\r\n                        \r\n                const res = await fetch(`http://localhost:5000/teachers/${id}`, {\r\n                    method: \"DELETE\",\r\n                })\r\n\r\n                res.status === 200 ? (this.teachers = this.teachers.filter((teacher) => teacher.id !== id)) : alert(\"Error deleting teacher\")\r\n                }\r\n            },\r\n            async EditTeacherForm(id, newTeacher) {\r\n                const teacherToEdit = await this.fetchTeacher(id);\r\n\r\n                const upTeacher = {\r\n                    id: teacherToEdit.id,\r\n                    ...newTeacher,\r\n                };\r\n\r\n                const res = await fetch(`http://localhost:5000/teachers/${id}`, {\r\n                    method: \"PUT\",\r\n                    headers: {\r\n                        \"Content-Type\": \"application/json\",\r\n                    },\r\n                    body: JSON.stringify(upTeacher),\r\n                });\r\n\r\n                const data = await res.json();\r\n\r\n                // Aggiorna la lista degli insegnanti con il nuovo dato ricevuto dal server\r\n                this.teachers = this.teachers.map((teacher) =>\r\n                    teacher.id === id ? { ...teacher, ...data } : teacher\r\n                );\r\n                \r\n                this.showEditTeacherForm = !this.showEditTeacherForm\r\n            },\r\n            async createTeacher(teacher) {\r\n                const res = await fetch(\"http://localhost:5000/teachers\", {\r\n                    method: \"POST\",\r\n                    headers: {\"Content-Type\": \"application/json\"},\r\n                    body: JSON.stringify(teacher),\r\n                })\r\n\r\n                const data = await res.json()\r\n\r\n                this.teachers = [...this.teachers, data]\r\n                this.showForm = !this.showForm\r\n                this.showCreateTeacher = !this.showCreateTeacher\r\n            },\r\n            \r\n        }\r\n\r\n    }\r\n</script>"],"mappings":";;EAEWA,KAAK,EAAC;AAAgB;;EAGtBA,KAAK,EAAC;AAAgB;;;;;6EAJ7BC,YAAA,CAAmOC,4BAAA;IAAhLC,qBAAqB,EAAEC,IAAA,CAAAC,mBAAmB;IAAGC,aAAY,EAAEC,QAAA,CAAAC,eAAe;IAAGC,eAAc,EAAEF,QAAA,CAAAG,aAAa;IAAGC,QAAQ,EAAEP,IAAA,CAAAO,QAAQ;IAAGC,mBAAmB,EAAER,IAAA,CAAAS;uIAA/KT,IAAA,CAAAU,qBAAqB,E,mBAC9CC,mBAAA,CAEM,OAFNC,UAEM,GADJf,YAAA,CAA8FgB,yBAAA;IAA7EC,eAAc,EAAEX,QAAA,CAAAY,aAAa;IAAGhB,qBAAqB,EAAEC,IAAA,CAAAC;2GADtCD,IAAA,CAAAgB,iBAAiB,E,mBAGrDL,mBAAA,CAEM,OAFNM,UAEM,GADJpB,YAAA,CAA0HqB,0BAAA;IAAxGhB,aAAY,EAAEC,QAAA,CAAAC,eAAe;IAAGI,mBAAmB,EAAER,IAAA,CAAAS,qBAAqB;IAAGU,OAAO,EAAEnB,IAAA,CAAAoB;kHADtEpB,IAAA,CAAAqB,mBAAmB,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}